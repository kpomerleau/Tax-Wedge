income<-37000
TotalTaxBurden<-function(income, children, married, hoh){
#Step 1: Grab State
stateparam<-StateParameters(state)
#Step 2: State Taxable Income
#Place holder for states with deductability
federalincometax<-0
statetaxableincome<-StateTaxableIncome(income,children,married,hoh,federalincometax,stateparam)
#Step 3: State Income Tax
stateincometax<-StateIncomeTax(statetaxableincome,married,hoh,stateparam)
#Step 4: State EITC
#First need federal EITC:
eitc<-FedEITC(income,children,married)
stateeitc<-StateEITC(eitc,stateparam)
#Step 5: Personal Credit (if applicable)
personalcredit<-StatePersonalCredit(income,statetaxableincome,married,hoh,children,stateparam)
#Step 6: Total State Income Tax
#If the EITC is not Refundable, state income tax needs a 0 lower bound
if(stateparam$eitcrefund[1] == 1){
stateincometax<-stateincometax-personalcredit-stateeitc
} else {
stateincometax<-max(0,stateincometax-personalcredit-eitc)
}
#Step 7: Federal Taxable Income
taxableincome<-FedTaxableIncome(income, children, married, hoh, stateincometax)
#Step 8: Federal Income Tax
federalincometax<-FedIncomeTax(taxableincome,married,hoh)
#Step 9: Child Tax Credit
ctc<-FedCTC(income,children,married)
#Federal Income Tax
federalincometax<-federalincometax-ctc-eitc
#Reserved for Recalculating fed deductability
#Payroll Taxes
employeepayrolltax<-FedEmployeePayroll(income,married)
#Total Tax Burden
taxburden<-stateincometax+federalincometax+employeepayrolltax
return(stateincometax)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
StateParameters<-function(state){
stateparam<-statetax[statetax$id == state,]
return(stateparam)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
FedTaxableIncome<-function(income, children, married, hoh, stateincometax){
if(income>fedtax$pep_pease_threshold[1+married+(hoh*2)]){
personalexemption<-max(0,(1-(((income-fedtax$pep_pease_threshold[1+married+(hoh*2)])/2500)*.02)))*(fedtax$personal_exemption[1]*(1+children+married))
} else {
personalexemption<-fedtax$personal_exemption[1]*(1+children+married)
}
#Calculating STANDARD/ITEMIZED DEDUCTION
if(stateincometax>fedtax$standard_deduction[1+married+(hoh*2)]){
if(income>fedtax$pep_pease_threshold[1+married+(hoh*2)]){
deduction<-stateincometax-((income-fedtax$pep_pease_threshold[1+married+(hoh*2)])*.03)
} else {
deduction<-stateincometax
}
} else {
deduction<-fedtax$standard_deduction[1+married+(hoh*2)]
}
taxableincome<-max(0,income-deduction-personalexemption)
return(taxableincome)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 100){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
write.table(mat,sep=",",file="test.txt")
View(mat)
View(statetax)
View(statetax)
TotalTaxBurden<-function(income, children, married, hoh){
#Step 1: Grab State
stateparam<-StateParameters(state)
#Step 2: State Taxable Income
#Place holder for states with deductability
federalincometax<-0
statetaxableincome<-StateTaxableIncome(income,children,married,hoh,federalincometax,stateparam)
#Step 3: State Income Tax
stateincometax<-StateIncomeTax(statetaxableincome,married,hoh,stateparam)
#Step 4: State EITC
#First need federal EITC:
eitc<-FedEITC(income,children,married)
stateeitc<-StateEITC(eitc,stateparam)
#Step 5: Personal Credit (if applicable)
personalcredit<-StatePersonalCredit(income,statetaxableincome,married,hoh,children,stateparam)
#Step 6: Total State Income Tax
#If the EITC is not Refundable, state income tax needs a 0 lower bound
if(stateparam$eitcrefund[1] == 1){
stateincometax<-stateincometax-personalcredit-stateeitc
} else {
stateincometax<-max(0,stateincometax-personalcredit-eitc)
}
#Step 7: Federal Taxable Income
taxableincome<-FedTaxableIncome(income, children, married, hoh, stateincometax)
#Step 8: Federal Income Tax
federalincometax<-FedIncomeTax(taxableincome,married,hoh)
#Step 9: Child Tax Credit
ctc<-FedCTC(income,children,married)
#Federal Income Tax
federalincometax<-federalincometax-ctc-eitc
#Reserved for Recalculating fed deductability
#Payroll Taxes
employeepayrolltax<-FedEmployeePayroll(income,married)
#Total Tax Burden
taxburden<-stateincometax+federalincometax+employeepayrolltax
return(taxburden)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 100){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
plot(income,averagetaxrate)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 100){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,averagetaxrate)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*100
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,averagetaxrate)
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
TotalTaxBurden<-function(income, children, married, hoh){
#Step 1: Grab State
stateparam<-StateParameters(state)
#Step 2: State Taxable Income
#Place holder for states with deductability
federalincometax<-0
statetaxableincome<-StateTaxableIncome(income,children,married,hoh,federalincometax,stateparam)
#Step 3: State Income Tax
stateincometax<-StateIncomeTax(statetaxableincome,married,hoh,stateparam)
#Step 4: State EITC
#First need federal EITC:
eitc<-FedEITC(income,children,married)
stateeitc<-StateEITC(eitc,stateparam)
#Step 5: Personal Credit (if applicable)
personalcredit<-StatePersonalCredit(income,statetaxableincome,married,hoh,children,stateparam)
#Step 6: Total State Income Tax
#If the EITC is not Refundable, state income tax needs a 0 lower bound
if(stateparam$eitcrefund[1] == 1){
stateincometax<-stateincometax-personalcredit-stateeitc
} else {
stateincometax<-max(0,stateincometax-personalcredit-eitc)
}
#Step 7: Federal Taxable Income
taxableincome<-FedTaxableIncome(income, children, married, hoh, stateincometax)
#Step 8: Federal Income Tax
federalincometax<-FedIncomeTax(taxableincome,married,hoh)
#Step 9: Child Tax Credit
ctc<-FedCTC(income,children,married)
#Federal Income Tax
federalincometax<-federalincometax-ctc-eitc
#Reserved for Recalculating fed deductability
#Payroll Taxes
employeepayrolltax<-FedEmployeePayroll(income,married)
#Total Tax Burden
taxburden<-stateincometax+federalincometax+employeepayrolltax
return(federalincometax)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*100
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
View(statetax)
state<-36
TotalTaxBurden<-function(income, children, married, hoh){
#Step 1: Grab State
stateparam<-StateParameters(state)
#Step 2: State Taxable Income
#Place holder for states with deductability
federalincometax<-0
statetaxableincome<-StateTaxableIncome(income,children,married,hoh,federalincometax,stateparam)
#Step 3: State Income Tax
stateincometax<-StateIncomeTax(statetaxableincome,married,hoh,stateparam)
#Step 4: State EITC
#First need federal EITC:
eitc<-FedEITC(income,children,married)
stateeitc<-StateEITC(eitc,stateparam)
#Step 5: Personal Credit (if applicable)
personalcredit<-StatePersonalCredit(income,statetaxableincome,married,hoh,children,stateparam)
#Step 6: Total State Income Tax
#If the EITC is not Refundable, state income tax needs a 0 lower bound
if(stateparam$eitcrefund[1] == 1){
stateincometax<-stateincometax-personalcredit-stateeitc
} else {
stateincometax<-max(0,stateincometax-personalcredit-eitc)
}
#Step 7: Federal Taxable Income
taxableincome<-FedTaxableIncome(income, children, married, hoh, stateincometax)
#Step 8: Federal Income Tax
federalincometax<-FedIncomeTax(taxableincome,married,hoh)
#Step 9: Child Tax Credit
ctc<-FedCTC(income,children,married)
#Federal Income Tax
federalincometax<-federalincometax-ctc-eitc
#Reserved for Recalculating fed deductability
#Payroll Taxes
employeepayrolltax<-FedEmployeePayroll(income,married)
#Total Tax Burden
taxburden<-stateincometax+federalincometax+employeepayrolltax
return(stateincometax)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*100
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
plot(income,averagetaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
TotalTaxBurden<-function(income, children, married, hoh){
#Step 1: Grab State
stateparam<-StateParameters(state)
#Step 2: State Taxable Income
#Place holder for states with deductability
federalincometax<-0
statetaxableincome<-StateTaxableIncome(income,children,married,hoh,federalincometax,stateparam)
#Step 3: State Income Tax
stateincometax<-StateIncomeTax(statetaxableincome,married,hoh,stateparam)
#Step 4: State EITC
#First need federal EITC:
eitc<-FedEITC(income,children,married)
stateeitc<-StateEITC(eitc,stateparam)
#Step 5: Personal Credit (if applicable)
personalcredit<-StatePersonalCredit(income,statetaxableincome,married,hoh,children,stateparam)
#Step 6: Total State Income Tax
#If the EITC is not Refundable, state income tax needs a 0 lower bound
if(stateparam$eitcrefund[1] == 1){
stateincometax<-stateincometax-personalcredit-stateeitc
} else {
stateincometax<-max(0,stateincometax-personalcredit-eitc)
}
#Step 7: Federal Taxable Income
taxableincome<-FedTaxableIncome(income, children, married, hoh, stateincometax)
#Step 8: Federal Income Tax
federalincometax<-FedIncomeTax(taxableincome,married,hoh)
#Step 9: Child Tax Credit
ctc<-FedCTC(income,children,married)
#Federal Income Tax
federalincometax<-federalincometax-ctc-eitc
#Reserved for Recalculating fed deductability
#Payroll Taxes
employeepayrolltax<-FedEmployeePayroll(income,married)
#Total Tax Burden
taxburden<-stateincometax+federalincometax+employeepayrolltax
return(taxburden)
}
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*100
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1000){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
View(statetax)
View(mat)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1001){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1002){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1002){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1005){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
plot(income,marginaltaxrate)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 1005){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-NULL
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-5
while (b < 1005){
income[b]<-b*1000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-NULL
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 105){
income[b]<-b*10000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-NULL
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
marginaltaxrate<-NULL
averagetaxrate<-NULL
taxbill<-NULL
income<-NULL
b<-1
while (b < 150){
income[b]<-b*10000
taxbill[b]<-TotalTaxBurden(income[b],children,married,hoh)
marginaltaxrate[b]<-(TotalTaxBurden(income[b],children,married,hoh)-TotalTaxBurden(income[b]-1,children,married,hoh))/1
averagetaxrate[b]<-TotalTaxBurden(income[b],children,married,hoh)/income[b]
b<-b+1
}
plot(income,marginaltaxrate)
mat<-NULL
mat<-cbind(income,marginaltaxrate,averagetaxrate,taxbill)
View(mat)
